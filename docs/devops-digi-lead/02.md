# 2.IT 僵局

Faster Software Development Versus Operational Stability

自从我们在 20 世纪 50 年代打开商用计算机的开关以来，IT 部门一直在努力跟上对软件应用程序和服务的贪得无厌的需求。当然，商业软件包、虚拟化和云计算等许多技术都有所帮助，但总体而言，IT 交付缓慢且不协调。

在这样一个环境中，IT 通常支持以内部为中心的业务流程，由独立的团队监督分散的技术功能多年来被认为是一种规范。但在当今快速发展的数字世界中，这些做法不再奏效。

## 一个充满“邪恶”商业问题的世界

与当今 IT 部门面临的“棘手”问题相比，满足支持业务流程的内部应用程序的变更需求是微不足道的。就像全球变暖和药物滥用等社会问题一样，它们是邪恶的，因为它处于一个不值得羡慕的位置，即试图在问题被完全理解之前快速提供解决方案，并且业务条件不断变化。这归因于三种变革力量:

*   从产品到服务——客户现在更关心整体体验，而不是物质。这解释了为什么公司把实体产品包装在服务中。比如特斯拉，他们经常通过软件对 Model S 汽车进行改进。或者是博世，它现在提供定制的远程信息处理和分析即服务，以便车队运营商可以优化维护和削减燃料成本。
*   从效率到灵活性——拥有数十年声誉的知名品牌不断被颠覆。柯达用了 100 年，百视达不到 20 年。甚至像微软这样的技术中坚分子也感受到了他们脚下的地面移动。商业声誉是由数字技术的娴熟和领先市场的能力——或创造新的能力——打造的。
*   分离到融合—物理产品和软件之间不再分离。你的智能手机是电路和塑料，还是 Spotify 音乐服务和数字支付系统？你的 Nest home 恒温器是一个美观的电器，还是一个能源管理的分析奇迹？

在这种环境下，棘手的问题挑战着如何开展业务以及如何设计、开发和支持应用程序的本质。由于移动性和社交计算，生产者-消费者关系已经被逆转，企业被置于必须对客户行为做出反应而不是发号施令的位置。由于传统的开发实践，这使得许多组织处于不利地位。

由大型复杂应用程序支持的内部业务流程一直是业务的命脉。为了支持物流、库存和财务管理等流程，这些应用程序会定期进行优化，以提高运营成本效率。在这种情况下，对它的关注一直是保持稳定状态；保持技术亮点，只在较长的周期内改变应用程序，有时一年只改变一两次。

即使进行定制开发，通常的做法也是在应用软件上大量投资，以支持大型项目。在这里，模式是在开始时定义所有的需求和特性，并通过以线性的方式开发和测试，将应用程序推向生产状态。最后，如果许多业务涉众同意系统是他们所需要的，那么应用程序就被移交给生产部门，由 IT 运营部门来维护。

考虑到这些力量，这种“瀑布”式的开发(见图 [2-1](#Fig1) )现在有许多缺点。首先，通过预先建立完全定义的需求集，然后未能适应变化的客户行为，组织冒着交付“白象”应用程序的风险，这些应用程序是客户从未使用过的软件系统。第二，在发布软件的时间里，业务条件可能已经改变，这意味着各部门必须彻底改变系统，或者像通常情况那样，完全放弃它。最后，由于应用软件和功能是一起交付的，IT 运营的支持和维护负担会突然显著增加。

![A371971_1_En_2_Fig1_HTML.gif](A371971_1_En_2_Fig1_HTML.gif)

图 2-1。

Waterfall software development model

## 敏捷开发的出现

在一级方程式赛车中，规则每个赛季都在变化。现在的汽车没有加油站，而是使用降解更快的轮胎进行竞争。It 部门也是如此，软件现在必须作为一个持续的价值流来交付，这个价值流不断变化以支持新的业务条件。

试图用现有的方法(如瀑布法)解决棘手的业务问题(例如，用新的移动销售渠道转变业务运营模式)就像试图圈养猫一样。随着新解决方案的考虑和实现，问题定义和需求可能会发生变化，因此在软件开发生命周期中需要更多的灵活性。而且，对于什么实际上构成了一个业务问题，有许多不同的观点，将会有许多利益相关者参与进来，有许多想法需要分析。

敏捷开发已经成为解决这些挑战的实践选择。敏捷(见图 [2-2](#Fig2) )涉及迭代解决问题和持续反馈，非常适合解决这些复杂的业务问题。一些常见的好处包括:

![A371971_1_En_2_Fig2_HTML.gif](A371971_1_En_2_Fig2_HTML.gif)

图 2-2。

Agile software development model

*   软件更新是定期小批量进行的，允许企业快速适应新信息
*   错误或错误的假设在软件生命周期的更早阶段被发现，在此阶段纠正它们的成本要低得多
*   通过尽早快速地发现问题，团队可以更快地获得反馈，组织知识也得以提高
*   团队可以立即应用学到的知识来提高应用软件的质量
*   通过在开发和测试中并行工作，敏捷团队可以提高应用程序开发和交付的速度

敏捷方法帮助团队管理和运行他们自己的项目。敏捷支持这样一种理念，即完全自治的团队应该能够做出自己的架构设计决策，即使是在工具的使用和决定将软件代码一直推向生产的过程中需要什么的时候，而不是在多个阶段等待批准和签署。

但是敏捷开发并不是没有缺点。虽然敏捷开发团队关注的是速度和敏捷性，但 IT 运营的传统信条是维护应用程序的稳定性，即使这意味着减慢速度。为此，IT 运营部门通常采用严格的变更控制流程，并强制实施基础架构标准化规定来保持控制。虽然这些流程非常适合支持大批量交付更新的遗留内部系统，但它们可能过于僵化，无法支持不断变化的新应用程序。

这些问题中有许多是传统 IT 运营方式的直接后果。过去，IT 运营是作为一组共享服务交付的，由数据中心服务、网络管理和安全性等领域的职能部门提供支持。如果业务用户或开发需要支持服务(例如，供应测试实验室)，运营必须参与交付。

然而，这种模式正在发生变化，新的工具和方法使业务组和开发团队能够完全绕过 IT 运营共享服务。许多最新的技术趋势都支持这些实践，包括:

*   多语言编程语言/平台——自主团队可以选择最适合他们项目的编程语言。这可能包括 Java 和 C++等较老的语言，或者支持特定开发用例或设计需求的新平台和语言(例如，Node。JS，Go，还有 Rust)。在其他情况下，开发团队会避开传统的关系数据库，转而使用 NoSQL 或文档风格的数据存储。在数据需求不确定或不断变化的项目中，以及在速度和可伸缩性比预先逻辑设计和数据完整性更重要的项目中，这可能是有利的。例子包括 MongoDB、PostgreSQL 和 Cassandra。
*   可编程基础设施—也称为基础设施即代码，这允许团队编写代码来管理配置和自动化基础设施供应。与其使用手动方法或脚本来构建开发就绪的基础设施，团队可以用他们熟悉的语言编写代码，并使用熟悉的实践(如版本控制和自动化测试)来减少错误。与主要用于自动化静态步骤的脚本不同，可编程基础设施及其描述性语言允许开发人员编写更加通用和适应性更强的流程。例子包括厨师，木偶，和 Ansible。
*   开源软件——除了更明显的“免费使用”的好处之外，许多组织正在采用开源软件(OSS)作为提高敏捷性的手段。通过采用 OSS，开发团队可以从基于社区的协作开发中受益，利用工具简化和自动化许多任务(例如，版本控制和软件构建管理)。通过“社区”对软件的关注，bug 可以被快速识别和解决，新的改进不断被开发和交付。
*   云和平台即服务(PaaS)—不久前，测试新应用或更新需要开发经理提交采购新硬件的业务案例，等待数周才能交付，然后经历艰难的配置和配置过程。这种情况在最近几年发生了变化，首先是服务器虚拟化的出现，最近是 PaaS 为开发和测试提供完整的云技术堆栈。
*   容器——最近的一项技术创新，容器构成了一个完整的运行时环境，包括应用程序，以及运行它所需的所有依赖项、库和配置文件——所有这些都打包在一个包中。通过将应用程序平台和所有依赖项容器化，操作系统发行版和底层基础设施中的任何差异都被抽象掉了。与虚拟机不同，容器化的应用程序运行单个操作系统，每个容器与其他容器共享操作系统内核。这使得容器比虚拟机更加轻量级和资源高效。容器可以在公共云服务上运行，并且易于共享，这使得它们对于开发和测试团队特别有用。
*   金丝雀发布/黑暗启动——这是一种发布方法，用于以分阶段的方式测试软件部署和新功能的性能。Canary 版本是敏捷开发的一个重要方面，因为，通过逐步推出新特性并与真实用户一起测试，团队可以收集反馈并快速实现改进。
*   为失败而设计—随着企业采用公共云服务，团队正在采用设计方法使应用程序完全独立于底层基础架构的可用性。通过构建弹性系统，其中不可避免的故障对服务的影响最小，故障设计允许团队快速扩展应用程序，同时实现更高水平的正常运行时间，即使在主要云基础架构停机期间也是如此。

### 敏捷授权挑战

虽然上面描述的许多技术和方法使团队能够更快地交付软件，但这并不能保证成功。虽然开发人员的任务是生成优秀的软件代码，但他们经常忽略与应用程序性能和可支持性相关的关键问题。在许多情况下，新技术和实践的采用加剧了这个问题，这是由于一些常见的缺陷:

为了技术而技术——开发人员希望使用最新的工具是可以理解的，但是这可能会导致支持问题。例如，选择 NoSQL 数据库是因为它有助于避免冗长的模式设计问题，这可能会解决短期问题，但会增加支持负担，因为 it 运营和支持人员对该技术没有经验。通过增加培训成本和雇佣专家，运营成本结构也会受到影响。

Tip

使新技术工具的选择成为一项协作练习。企业架构师可以指导团队将项目或业务级别的目标置于离散的工具需求或个人偏好之上的重要性。

滥用新技术——事实上，新技术经常会被滥用，不管是有意还是无意。对于现代技术，缺乏经验可能会诱使人们以他们从未设计过的方式使用技术。例如，盲目地规定每个单一的和遗留的应用程序都应该容器化，不管它们是否适合技术。

Tip

今天的新技术是明天的遗产。始终评估技术的使用是否适合业务，并且永远不要低估架构和设计需求。

衡量标准不一致——随着开发人员使用 canary releases、dark launches 和 split 或 A/B 测试等技术，企业需要知道新功能是否成功，是否带来了更多的客户转化和销售。然而，从历史上看，IT 运营部门使用技术诊断作为评估性能的手段，这可能与业务不一致。

Tip

考虑采用更注重实现预期业务成果的监控方法。在移动应用环境中，这可能包括按地理区域和用户群体分析应用和功能使用的监控技术。通过管理这些结果，可以更容易地评估任何应用程序性能问题的影响，并将更丰富的信息和见解反馈给开发。

失去的机会——随着新开发平台越来越脱离硬件基础设施，许多复杂的性能问题可能会浮出水面。因为开发人员不受基础设施的影响，所以他们对代码引入的任何问题的反应可能会很慢。这种洞察力的缺乏也意味着他们无法充分挖掘新的基于云的技术的真正潜力。

Tip

在以客户为中心的计算中，高性能和低延迟与功能和设计同等重要。考虑将初级和有经验的开发人员与熟练的 IT 运营和系统管理员组成团队，以确定如何更好地利用现代硬件架构来持续提供高质量的客户体验。

由于限制而产生的变通办法——即使团队希望采用公共云服务和 PaaS 来加速开发，他们仍然受到访问生产系统进行测试的限制。这可能包括延迟访问应用程序、基础架构，以及可能是 IT 中最耗时、最耗费资源的任务—创建、维护和调配准确、合规和最新的类似生产的测试数据。有了这些限制，团队可能会引入次优的测试实践，这些实践不能检测软件缺陷或者损害对监管数据保护需求的遵从。

Tip

考虑可以在开发生命周期中模拟不可用系统的技术。这允许开发人员、测试人员和集成团队并行工作，以便更快地交付。还应该评估测试数据管理的能力，包括数据子集设置和屏蔽，以及合成的按需测试数据生成。

## 现代应用架构

为了支持创新的业务需求，开发团队必须不断地以更快的速度交付软件服务。网飞和亚马逊等网络本土公司已经认识到了这一点，他们已经改变了自己的软件架构，以支持持续创新的需求——本质上是用它们来重新定义他们经营的市场。

使用敏捷方法，组织可以快速迭代以支持创新，但团队也在改变应用程序架构以提高软件灵活性并帮助加速部署。出于这个原因，老式的整体式设计正在被微维修设计所补充(见图 [2-3](#Fig3) )。

![A371971_1_En_2_Fig3_HTML.gif](A371971_1_En_2_Fig3_HTML.gif)

图 2-3。

Monolthic and microservice application architectures

直到最近，应用程序架构在设计和操作上都是单一的。尽管由许多服务组成，但整体应用程序是作为一个单元打包和操作的。对于现在负责更快交付和部署的 IT 团队来说，整体式设计的特点带来了许多运营挑战:

*   脆性——如果组件的任何一个应用程序元素失败，那么整个应用程序都会失败。如果像支付处理这样的任务消耗了更多的 CPU 或内存，那么整个应用程序就会降级。
*   风险——因为一切都打包在一起(并且一起失败),团队可能不愿意改变支持技术栈和基础设施。这可以解释操作人员对增加部署率的抗拒，因为即使是对脆弱的整体应用程序的简单应用程序更新也会导致系统级停机。
*   紧密耦合—应用程序只能通过在更多服务器上部署整个应用程序来扩展。在新的移动应用程序开发场景中，当需求难以预测时，这可能是一个很大的问题。
*   依赖性——由于应用程序被捆绑在一起，开发人员可能难以独立开发、测试和部署他们自己的软件组件。开发时间增加，生产率下降，因为他们经常依赖其他团队在开始之前完成工作。

微服务设计与整体服务的不同之处在于，它们将应用程序构建为一组小型的独立服务。本质上，每个微服务都专注于业务功能的一个特定元素。例如，在一个 web 应用程序中，可能有许多微服务支持从登录处理和购物车、推荐服务和支付处理的一切。微服务本质上是松散耦合，通过应用编程接口(API)与其他服务进行通信。

微服务可以为企业带来许多显著的好处:

*   独立部署—扩展问题变得更少。例如，在基于 web 的购物应用程序中，团队可以快速部署满足需求高峰所需的服务实例，同时缩减其他实例。
*   独立编码——团队可以更自由地使用不同的编程语言进行开发，每种语言都针对不同的处理任务进行了优化。微服务可以将组织从单一技术体系中解放出来。
*   容错—当微服务出现故障时，整个系统不太可能会出现故障。如果 web 应用程序中的推荐服务失败，购物车和支付处理服务可以继续运行。
*   提高敏捷性—微服务设计可以更好地支持持续交付。由于系统是独立构建和部署的，它们可能会被更快地测试和交付。

### 微服务:小并不总是美丽的

虽然微服务风格设计的简单和优雅特性带来了许多好处，但在管理和运营方面存在相当大的复杂性。如果被忽视，这些问题可能会增加开发和运营团队之间的摩擦。重要的考虑因素包括:

*   可支持性-支持负担可能会大幅增加-特别是当 IT 运营突然面临管理数百个以不同语言开发的微服务、访问新的数据存储以及在云平台和基础架构上运行时。
*   监控—管理单个整体应用程序是一项艰巨的任务，但现在 IT 运营部门必须确保更多流程保持高性能。随着高度分布式微服务系统的出现，一系列全新的管理问题浮出水面。这些包括网络延迟、容错、异步消息传递问题和网络可靠性。
*   协调——部署数百个微服务需要严格的部署流程，这可能超出了使用手动流程和脚本的团队的能力。

Note

解决微服务部署和监控挑战的现代管理方法将在第 [6](06.html) 和 [7](07.html) 章中进一步讨论。

## 结束技术僵局

即使在工具、开发方法和软件设计方面取得了进步，在分散的功能孤岛中运作的团队所产生的摩擦也会抵消所有潜在的好处。贯穿应用软件生命周期的破碎的过程不可避免地导致缓慢的交付、低生产率和充满缺陷的软件系统。这必须改变。

它的价值主张不仅仅是让技术保持运转，并在长周期内定期交付改进；它是从一个现代的高性能软件工厂中持续制造商业价值。

开发运维专注于开发和其他 IT 团队之间的紧密协作，同时自动化重要的应用交付流程，这是一项关键的业务需求。

## 摘要

以下章节概述了可帮助 IT 和数字领导者加速成功和业务一致的 DevOps 计划的关键策略。

从第 [3](03.html) 章开始，我们将描述如何建立一种成功的 DevOps 文化，并重振 IT 组织。在这里，我们将研究增加协作的简单且经济高效的方法、减少 IT 浪费的精益思想的应用，以及综合 DevOps 指标计划的构成。

[![Creative Commons](cc-by.png)](https://creativecommons.org/licenses/by/4.0)This chapter is distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License (http://creativecommons.org/licenses/by-nc-nd/4.0/), which permits any noncommercial use, duplication, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license and indicate if you modified the licensed material. You do not have permission under this license to share adapted material derived from this book or parts of it. The images or other third party material in this book are included in the work's Creative Commons license, unless indicated otherwise in the credit line; if such material is not included in the work's Creative Commons license and the respective action is not permitted by statutory regulation, users will need to obtain permission from the license holder to duplicate, adapt or reproduce the material.